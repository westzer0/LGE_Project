# 추천 문구 생성 로직 완료

## 구현 완료 사항

### 1. 768개 vs 400개 설명

**구조:**
- **768개**: 원본 취향 조합 수 (`taste_recommendations_768.csv`)
- **400개**: 유사도 분석으로 클러스터링된 Scoring Logic 그룹 수
- **관계**: 여러 taste_id가 하나의 Logic을 공유할 수 있음

**시뮬레이션:**
- 원본 768개 케이스를 모두 실행하여 각 taste_id별 추천 결과 확인
- 각 케이스는 자신의 taste_id에 매핑된 Scoring Logic을 사용

### 2. 각 케이스별 추천 문구 생성 로직

**구현 파일:**
- `api/services/recommendation_reason_generator.py`: 추천 문구 생성 서비스
- `api/services/recommendation_engine.py`: 추천 엔진에 통합

**생성 우선순위:**

1. **CSV의 리뷰_기반_추천문구 활용** (최우선)
   - `taste_recommendations_768.csv`에 이미 있는 추천 문구
   - 사용자 취향 정보로 개인화

2. **DB에 저장된 추천 이유 활용**
   - `ProductRecommendReason` 모델의 `reason_text`
   - 사용자 취향 정보로 개인화

3. **리뷰 분석 기반 생성**
   - 제품의 실제 리뷰(`ProductReview`) 분석
   - 취향 키워드와 매칭되는 리뷰 키워드 추출
   - 긍정 키워드 기반으로 문구 생성

4. **기본 문구** (최후)
   - 점수 기반 간단한 문구

**개인화 요소:**
- 가족 구성원 수 (1인 가구, 4인 가족 등)
- 우선순위 (디자인, 기술, 에너지 효율, 가성비)
- 인테리어 스타일 (모던, 코지, 럭셔리, 유니크)

## 사용 방법

### 추천 엔진에서 자동 사용

```python
from api.services.recommendation_engine import RecommendationEngine

engine = RecommendationEngine()

# taste_id와 taste_info를 함께 전달
result = engine.get_recommendations(
    user_profile=user_profile,
    taste_id=123,
    taste_info={
        '인테리어_스타일': '모던 & 미니멀',
        '메이트_구성': '1인 가구',
        '우선순위': '디자인',
        '리뷰_기반_추천문구': '...',  # CSV에서 가져온 문구
    }
)

# 각 추천에 'reason' 필드에 추천 문구가 포함됨
for rec in result['recommendations']:
    print(rec['reason'])  # 개인화된 추천 문구
```

### 시뮬레이션에서 사용

```bash
# 시뮬레이션 실행 시 자동으로 추천 문구 생성
python manage.py simulate_taste_recommendations --limit 10
```

## 예시 추천 문구

### CSV 기반 (개인화 전)
```
"혼자만의만의 모던 & 미니멀 무드
인테리어를 완성하는 디자인을 중시하는 당신을 위해
LG 트롬 오브제컬렉션 세탁기21kg1등급를 골라봤어요.
리뷰에서 역시, 조용하고, 세탁, 가전은, 있어 등의 긍정적 피드백이 많았어요.
500만원 미만 (실속형) 예산으로 완벽한 조합을 제안합니다."
```

### 개인화 후
```
"1인 가구에 적합한 디자인을 중시하는 당신을 위해, 혼자만의만의 모던 & 미니멀 무드
인테리어를 완성하는 디자인을 중시하는 당신을 위해
LG 트롬 오브제컬렉션 세탁기21kg1등급를 골라봤어요..."
```

### 리뷰 분석 기반
```
"리뷰에서 '디자인'에 대한 긍정적 피드백이 15회 이상 나타났습니다. 1인 가구에 적합합니다."
```

## 다음 단계

1. **전체 시뮬레이션 재실행**: 추천 문구가 포함된 결과 생성
2. **추천 문구 품질 검증**: 생성된 문구의 적절성 확인
3. **문구 개선**: 필요시 키워드 매핑 및 생성 로직 개선

